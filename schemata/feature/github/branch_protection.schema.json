{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://github.com/apache/infrastructure-asfyaml/feature/github.asfyaml.schema",
  "title": "Branch protection",
  "description": "Configures branch protection rules. See: https://github.com/apache/infrastructure-asfyaml?tab=readme-ov-file#branch-protection",
  "type": "object",
  "additionalProperties": {
    "type": "object",
    "properties": {
      "required_signatures": {
        "type": "boolean",
        "default": false
      },
      "required_linear_history": {
        "type": "boolean",
        "default": false
      },
      "required_conversation_resolution": {
        "type": "boolean",
        "default": false
      },
      "required_pull_request_reviews": {
        "type": "object",
        "properties": {
          "dismiss_stale_reviews": {
            "type": "boolean",
            "default": false
          },
          "require_last_push_approval": {
            "type": "boolean",
            "default": false
          },
          "require_code_owner_reviews": {
            "type": "boolean",
            "default": false
          },
          "required_approving_review_count": {
            "type": "integer",
            "default": 0
          }
        }
      },
      "required_status_checks": {
        "type": "object",
        "properties": {
          "strict": {
            "type": "boolean",
            "default": false
          },
          "contexts": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "checks": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "context": {
                  "type": "string"
                },
                "app_id": {
                  "type": "integer"
                },
                "required": [
                  "context",
                  "app_id"
                ]
              }
            }
          }
        }
      }
    }
  }
}